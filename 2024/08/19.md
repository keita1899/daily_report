# 8/19

## 取り組んだこと

- Jest 公式ドキュメント

## 学んだこと

### Jest 公式ドキュメント

- はじめに
  - `npm install --save-dev jest`で jest をインストールする
  - `〇〇.test.js`ファイルを作成する
  - `npm init jest@latest`で基本の設定ファイルを作成する
  - Jest は Babel 経由で TypeScript をサポートしているが、Jest はテスト実行時にテストコードの型検査は行わない
  - 型検査を行う場合は`ts-jest`をインストールする
  - `expect(テストを行う対象).toBe(期待する結果)`の形で書く
  - `toBe`は厳密な等価性をテストする
  - `toEqual`はオブジェクトまたは配列のすべてのフィールドを再帰的にチェックする
  - `toBeNull`は null のみ一致する
  - `toBeUndefined`は undefined のみ一致する
  - `toBeTruthy`は if 文で真になるもののみ一致する
  - `toBeFalsy`は if 文で偽になるもののみ一致する
  - `toMatch`で文字列が正規表現に一致するか確認する
  - `toContain`で配列やオブジェクトに特定の要素が含まれているか確認する
  - 例外を投げることをテストするには`toThrow`を使う
  - 非同期処理をテストする場合は、Jest はテスト対象のコードがいつ完了したかを別のテストに進む前に知る必要がある
  - テストが Promise を返す場合、Jest は resolve されるまで待機し、reject されるとテストが失敗する
  - `async`と`await`も同じようにテストで使える
  - 非同期処理が失敗することをテストする場合は`.catch`を使い、想定した数のアサーションが呼ばれたことを確認するため、`expect.assertions`を必ず追加する
  - それぞれのテストでセットアップや後片付けを行う場合は`beforeEach`と`afterEach`を使い、テスト全体で行う場合は`beforeAll`と`afterAll`を使う
  - セットアップと後片付けのメソッドはファイル全体に適用されるが、`describe`を使うとそのブロック内のテストのみ適用される
  - `test.only`で特定のテストだけ実行できる
  - モックを使うと関数の実装を取り除き、テスト中に関数がどのように呼び出されたかを確認できる
- ガイド
  - スナップショットテストは UI が予期せぬ変更が行われていないかをテストする
  - 初回テスト時にレンダリングされたコンポーネントのスナップショットが保存される
  - `jest --updateSnapshot`もしくは`jest -u`コマンドでスナップショットを更新できる
  - インタラクティブ・スナップショットモードに入ると、Jest は一度に 1 つのテストごとに、失敗したスナップショットをステップ実行させてくれる
  - `toMatchInlineSnapshot()`を使うと、スナップショットの内容をインラインで保存できる
  - スナップショットはプルリクエストで簡単に確認できるように範囲を絞り込んで短くすべき
  - スナップショットがカバーするモジュールとテストと共にすべてのスナップショットファイルはコミットされるべき
  - スナップショットはテキストファイルに保管されるので、テストは高速で信頼性が高いものになる
  - テストは再現可能であるべきで、同じコンポーネントに対するテストは毎回同じ結果を返すようにする
  - テストでネットワークへの接続は行いたくないので、モックで実装する
- フレームワークガイド
  - Jest は Create React App に含まれている
  - Testing Library はユーザーが UI をどのように利用するかを重点においたテスト

## わからなかったこと

- 非同期処理のテスト
- モックの意味

## 次やること

- udemy React 完全入門ガイド
  - 14
  - 16
  - 20
  - 21

## 感想

公式ドキュメントはざっくり読んで概要だけ把握する。細かい実装の部分は実際に使うときでいいや。正直モックの部分とかほとんどわからん。
